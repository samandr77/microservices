# üìß Notification Service

–°–µ—Ä–≤–∏—Å –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏ —Å–æ–æ–±—â–µ–Ω–∏–π.

## –û–ø–∏—Å–∞–Ω–∏–µ

Notification Service –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ, –≤–∫–ª—é—á–∞—è –æ—Ç–ø—Ä–∞–≤–∫—É email-—Å–æ–æ–±—â–µ–Ω–∏–π, –∫–æ–¥–æ–≤ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –¥—Ä—É–≥–∏—Ö —Ç–∏–ø–æ–≤ –æ–ø–æ–≤–µ—â–µ–Ω–∏–π. –†–∞–±–æ—Ç–∞–µ—Ç –≤ event-driven –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ, –ø–æ–ª—É—á–∞—è —Å–æ–±—ã—Ç–∏—è —á–µ—Ä–µ–∑ Kafka.

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **Email —Ä–∞—Å—Å—ã–ª–∫–∞** - –û—Ç–ø—Ä–∞–≤–∫–∞ email —á–µ—Ä–µ–∑ gomail (SMTP)
- **–û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–¥–æ–≤ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏** - –ö–æ–¥—ã –¥–ª—è –≤—Ö–æ–¥–∞ –≤ —Å–∏—Å—Ç–µ–º—É
- **Event-driven –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - Kafka consumer –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
- **–®–∞–±–ª–æ–Ω–∏–∑–∞—Ü–∏—è** - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ HTML —à–∞–±–ª–æ–Ω–æ–≤ –¥–ª—è –ø–∏—Å–µ–º
- **–ë–µ–∑ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π –ë–î** - Stateless —Å–µ—Ä–≤–∏—Å, —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å —Å–æ–±—ã—Ç–∏—è–º–∏

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Go** 1.23.0
- **Kafka** - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- **gomail** - SMTP –∫–ª–∏–µ–Ω—Ç –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ email
- **HTTP/REST API** - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
notification/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ cmd/              # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ internal/         # –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –ª–æ–≥–∏–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api/          # HTTP handlers –∏ —Ä–æ—É—Ç–∏–Ω–≥
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ events/   # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ Kafka —Å–æ–±—ã—Ç–∏–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ clients/      # –ö–ª–∏–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ gomail/   # Email –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ entity/       # –ë–∏–∑–Ω–µ—Å-—Å—É—â–Ω–æ—Å—Ç–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ service/      # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ pkg/             # –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–∞–∫–µ—Ç—ã
‚îî‚îÄ‚îÄ docker/              # Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```

## –ó–∞–ø—É—Å–∫

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

1. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```bash
cp example.env .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Ñ–∞–π–ª
```

2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (Kafka):
```bash
cd docker
docker-compose up -d
```

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å:
```bash
cd app
make run
```

### Docker

```bash
cd docker
docker-compose up
```

## API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É:
```
http://localhost:8083/swagger/index.html
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```env
# Server
SERVER_PORT=8083
LOG_LEVEL=debug

# Kafka
KAFKA_BROKERS=localhost:9092
KAFKA_CONSUMER_ID=notification-service
KAFKA_NOTIFICATION_TOPIC=notifications

# SMTP
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-app-password
SMTP_FROM=noreply@yourcompany.com
SMTP_FROM_NAME=Your Company

# Email Settings
EMAIL_VERIFICATION_CODE_SUBJECT=–ö–æ–¥ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
EMAIL_VERIFICATION_CODE_TEMPLATE=templates/verification_code.html
```

## –¢–∏–ø—ã —Å–æ–±—ã—Ç–∏–π

### Verification Code
–û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–¥–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–ª—è –≤—Ö–æ–¥–∞:
```json
{
  "type": "verification_code",
  "data": {
    "email": "user@example.com",
    "code": "123456",
    "name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤"
  }
}
```

### Custom Email
–ü—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ email-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:
```json
{
  "type": "custom_email",
  "data": {
    "to": "user@example.com",
    "subject": "–ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø–∏—Å—å–º–∞",
    "body": "–¢–µ–∫—Å—Ç –ø–∏—Å—å–º–∞",
    "html": "<h1>HTML –≤–µ—Ä—Å–∏—è</h1>"
  }
}
```

## –®–∞–±–ª–æ–Ω—ã

Email —à–∞–±–ª–æ–Ω—ã —Ä–∞—Å–ø–æ–ª–∞–≥–∞—é—Ç—Å—è –≤ `app/templates/`. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π Go templating.

–ü—Ä–∏–º–µ—Ä —à–∞–±–ª–æ–Ω–∞:
```html
<!DOCTYPE html>
<html>
<head>
    <title>{{.Subject}}</title>
</head>
<body>
    <h1>–ö–æ–¥ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏: {{.Code}}</h1>
    <p>–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, {{.Name}}!</p>
</body>
</html>
```

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
make test
```

### –õ–∏–Ω—Ç–∏–Ω–≥

```bash
make lint
```

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

```bash
make swagger
```

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- [github.com/samandr77/microservices/auth](../auth) - –∏—Å—Ç–æ—á–Ω–∏–∫ —Å–æ–±—ã—Ç–∏–π

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–°–µ—Ä–≤–∏—Å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –º–µ—Ç—Ä–∏–∫–∏:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö email
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏
- –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π

## –°—Å—ã–ª–∫–∏

- [–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π](https://github.com/samandr77/microservices)
